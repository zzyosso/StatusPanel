<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>奇幻世界探索</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 伪装模式开关提示 (仅桌面端) -->
    <div class="boss-key-hint" id="boss-key-hint">按 Ctrl+B 切换伪装模式</div>
    
    <!-- VSCode 风格伪装界面 -->
    <div id="disguise-mode" class="vscode-container" style="display: none;">
        <!-- 顶部菜单栏 -->
        <div class="vscode-menubar">
            <div class="vscode-logo">
                <svg width="24" height="24" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M95 25L70 5L30 40L10 25L5 30L30 55L5 80L10 85L30 70L70 105L95 85V25Z" fill="#007ACC"/>
                </svg>
            </div>
            <div class="vscode-menu">
                <span class="menu-item">文件</span>
                <span class="menu-item">编辑</span>
                <span class="menu-item">选择</span>
                <span class="menu-item">查看</span>
                <span class="menu-item">转到</span>
                <span class="menu-item">运行</span>
                <span class="menu-item">终端</span>
                <span class="menu-item">帮助</span>
            </div>
            <div class="vscode-title">algorithms.js - 数据结构与算法学习</div>
            <div class="vscode-controls">
                <span>―</span>
                <span>□</span>
                <span>✕</span>
            </div>
        </div>
        
        <!-- 主内容区 -->
        <div class="vscode-main">
            <!-- 侧边栏 -->
            <div class="vscode-sidebar">
                <div class="sidebar-icons">
                    <div class="icon active" title="资源管理器">📁</div>
                    <div class="icon" title="搜索">🔍</div>
                    <div class="icon" title="源代码管理">🌿</div>
                    <div class="icon" title="运行和调试">▶️</div>
                    <div class="icon" title="扩展">⚡</div>
                </div>
                <div class="sidebar-content">
                    <div class="sidebar-header">资源管理器</div>
                    <div class="file-tree">
                        <div class="folder open">
                            <span>📂 algorithm-learning</span>
                            <div class="folder-content">
                                <div class="file active">📄 algorithms.js</div>
                                <div class="file">📄 dataStructures.js</div>
                                <div class="file">📄 practice.js</div>
                            </div>
                        </div>
                        <div class="folder">
                            <span>📂 notes</span>
                        </div>
                        <div class="file">📄 README.md</div>
                        <div class="file">📄 progress.json</div>
                    </div>
                </div>
            </div>
            
            <!-- 编辑器区域 -->
            <div class="vscode-editor">
                <div class="vscode-tabs">
                    <div class="tab active">
                        <span class="tab-icon">JS</span>
                        <span class="tab-name">algorithms.js</span>
                        <span class="tab-close">×</span>
                    </div>
                </div>
                
                <div class="code-editor-split">
                    <div class="code-reference-panel">
                        <div class="panel-label">📚 参考代码</div>
                        <div class="code-editor">
                            <div class="line-numbers" id="ref-line-numbers"></div>
                            <div class="code-content">
                                <pre id="reference-code"></pre>
                            </div>
                        </div>
                    </div>
                    <div class="split-divider"></div>
                    <div class="code-practice-panel">
                        <div class="panel-label">✍️ 练习区 (开始打字)</div>
                        <div class="code-editor">
                            <div class="line-numbers" id="practice-line-numbers"></div>
                            <div class="code-content">
                                <pre id="practice-code"></pre>
                                <div class="cursor" id="cursor"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="vscode-statusbar">
            <div class="statusbar-left">
                <span class="status-item">🌿 main</span>
                <span class="status-item">⚠ 0 ✖ 0</span>
            </div>
            <div class="statusbar-right">
                <span class="status-item">UTF-8</span>
                <span class="status-item">LF</span>
                <span class="status-item">JavaScript</span>
                <span class="status-item" id="cursor-position">Ln 1, Col 1</span>
            </div>
        </div>
    </div>
    
    <!-- 游戏主界面 -->
    <div class="game-wrapper">
        <!-- 左侧书签导航 -->
        <nav class="bookmark-nav">
            <div class="bookmark-tab active" data-tab="home" title="首页">
                <span class="bookmark-icon">🏠</span>
                <span class="bookmark-text">首页</span>
            </div>
            <div class="bookmark-tab" data-tab="status" title="状态栏">
                <span class="bookmark-icon">📊</span>
                <span class="bookmark-text">属性</span>
            </div>
            <div class="bookmark-tab" data-tab="pet" title="我的宠物">
                <span class="bookmark-icon">🐾</span>
                <span class="bookmark-text">宠物</span>
            </div>
            <div class="bookmark-tab" data-tab="backpack" title="背包">
                <span class="bookmark-icon">🎒</span>
                <span class="bookmark-text">背包</span>
            </div>
            <div class="bookmark-tab" data-tab="storage" title="仓库">
                <span class="bookmark-icon">📦</span>
                <span class="bookmark-text">仓库</span>
            </div>
            <div class="bookmark-tab" data-tab="shop" title="商店">
                <span class="bookmark-icon">🛒</span>
                <span class="bookmark-text">商店</span>
            </div>
            <div class="bookmark-tab" data-tab="skills" title="技能树">
                <span class="bookmark-icon">⚡</span>
                <span class="bookmark-text">技能</span>
            </div>
            <div class="bookmark-tab" data-tab="map" title="思维地图">
                <span class="bookmark-icon">🗺️</span>
                <span class="bookmark-text">地图</span>
            </div>
            <div class="bookmark-tab" data-tab="challenge" title="考验">
                <span class="bookmark-icon">⚔️</span>
                <span class="bookmark-text">考验</span>
            </div>
            <div class="bookmark-tab settings" data-tab="settings" title="设置">
                <span class="bookmark-icon">⚙️</span>
                <span class="bookmark-text">设置</span>
            </div>
        </nav>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 顶部标题栏 -->
            <header class="game-header">
                <div class="header-left">
                    <h1 class="game-title">🌟 奇幻世界探索</h1>
                </div>
                <div class="header-center">
                    <div class="theme-switcher">
                        <button class="theme-btn active" data-theme="cyber" title="赛博朋克">🌃</button>
                        <button class="theme-btn" data-theme="strawberry" title="草莓粉">🍓</button>
                        <button class="theme-btn" data-theme="matcha" title="抹茶绿">🍵</button>
                        <button class="theme-btn" data-theme="glass" title="透明玻璃">💎</button>
                    </div>
                </div>
                <div class="header-right">
                    <div class="currency-display">
                        <span class="currency-item">💰 <span id="header-gold">100</span></span>
                        <span class="currency-item">🍖 <span id="header-food">0</span></span>
                    </div>
                </div>
            </header>

            <!-- 首页 - 游戏窗口布局 -->
            <section id="home" class="panel active game-home">
                <div class="home-grid">
                    <!-- 左上角 - 角色属性 -->
                    <div class="home-panel home-stats">
                        <div class="home-panel-header">
                            <span class="panel-icon">👤</span>
                            <span class="panel-title">角色属性</span>
                        </div>
                        <div class="home-panel-content">
                            <div class="mini-avatar">
                                <div class="avatar-frame">
                                    <span class="avatar-emoji">🧙</span>
                                </div>
                                <div class="avatar-info">
                                    <span class="avatar-name">冒险者</span>
                                    <span class="avatar-level">Lv.1</span>
                                </div>
                            </div>
                            <div id="home-stats-container" class="home-stats-list">
                            </div>
                        </div>
                    </div>

                    <!-- 左下角 - 背包快捷栏 -->
                    <div class="home-panel home-backpack">
                        <div class="home-panel-header">
                            <span class="panel-icon">🎒</span>
                            <span class="panel-title">快捷物品</span>
                            <button class="panel-more-btn" onclick="switchToTab('backpack')">更多 →</button>
                        </div>
                        <div class="home-panel-content">
                            <div id="home-backpack-items" class="quick-items-grid">
                            </div>
                        </div>
                    </div>

                    <!-- 中间 - 地图窗口 -->
                    <div class="home-panel home-map-window">
                        <div class="home-panel-header">
                            <span class="panel-icon">🗺️</span>
                            <span class="panel-title">探索地图</span>
                            <button class="panel-more-btn" onclick="switchToTab('map')">展开 →</button>
                        </div>
                        <div class="home-panel-content map-preview">
                            <div class="map-scene">
                                <div class="map-background">
                                    <div class="floating-element cloud1">☁️</div>
                                    <div class="floating-element cloud2">☁️</div>
                                    <div class="floating-element bird">🦅</div>
                                </div>
                                <div class="map-ground">
                                    <div class="map-element tree1">🌳</div>
                                    <div class="map-element tree2">🌲</div>
                                    <div class="map-element house">🏠</div>
                                    <div class="map-element castle">🏰</div>
                                    <div class="map-element mountain">⛰️</div>
                                </div>
                                <!-- 像素角色 -->
                                <div class="pixel-character-container" id="pixel-character-container" onclick="showCharacterMenu()">
                                    <div class="pixel-character" id="pixel-character">
                                        <div class="char-accessory" id="char-accessory"></div>
                                        <div class="char-hair" id="char-hair"></div>
                                        <div class="char-head" id="char-head"></div>
                                        <div class="char-eyes" id="char-eyes"></div>
                                        <div class="char-mouth" id="char-mouth"></div>
                                        <div class="char-body" id="char-body"></div>
                                        <div class="char-legs" id="char-legs"></div>
                                    </div>
                                    <div class="character-shadow"></div>
                                    <div class="character-name-tag" id="character-name-tag">冒险者</div>
                                </div>
                                <!-- 宠物跟随 -->
                                <div class="map-pet" id="map-pet-display">
                                    <div class="pixel-pet" id="pixel-pet">
                                        <span class="pet-sprite" id="pet-sprite-emoji">🐱</span>
                                    </div>
                                    <div class="pet-mood" id="pet-mood">💕</div>
                                </div>
                                <!-- 互动气泡 -->
                                <div class="interaction-bubble" id="interaction-bubble" style="display: none;">
                                    <span class="bubble-text" id="bubble-text">你好呀！</span>
                                </div>
                            </div>
                            <div class="map-info">
                                <span class="location-name">✨ 新手村</span>
                                <span class="location-desc">冒险的起点，充满希望的地方</span>
                            </div>
                            <!-- 角色操作栏 -->
                            <div class="character-actions">
                                <button class="char-action-btn" onclick="event.stopPropagation();showDressUpModal()" title="换装">
                                    <span>👔</span>
                                </button>
                                <button class="char-action-btn" onclick="event.stopPropagation();characterWave()" title="打招呼">
                                    <span>👋</span>
                                </button>
                                <button class="char-action-btn" onclick="event.stopPropagation();characterDance()" title="跳舞">
                                    <span>💃</span>
                                </button>
                                <button class="char-action-btn" onclick="event.stopPropagation();interactWithPet()" title="和宠物互动">
                                    <span>🐾</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 中间下方 - 考验/任务 -->
                    <div class="home-panel home-challenge">
                        <div class="home-panel-header">
                            <span class="panel-icon">⚔️</span>
                            <span class="panel-title">今日考验</span>
                            <button class="panel-more-btn" onclick="switchToTab('challenge')">全部 →</button>
                        </div>
                        <div class="home-panel-content">
                            <div class="quick-challenge">
                                <div class="challenge-card" onclick="switchToTab('challenge')">
                                    <span class="challenge-icon">🔢</span>
                                    <span class="challenge-name">算术挑战</span>
                                    <span class="challenge-reward">+10 经验</span>
                                </div>
                                <div class="challenge-card" onclick="switchToTab('challenge');setTimeout(()=>document.querySelector('[data-challenge=literacy]').click(),100)">
                                    <span class="challenge-icon">📖</span>
                                    <span class="challenge-name">识字训练</span>
                                    <span class="challenge-reward">+5 经验</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 右上角 - 技能预览 -->
                    <div class="home-panel home-skills">
                        <div class="home-panel-header">
                            <span class="panel-icon">⚡</span>
                            <span class="panel-title">技能</span>
                            <button class="panel-more-btn" onclick="switchToTab('skills')">详情 →</button>
                        </div>
                        <div class="home-panel-content">
                            <div class="skill-level-display">
                                <span class="skill-lv">Lv.<span id="home-skill-level">0</span></span>
                                <div class="skill-exp-mini">
                                    <div class="skill-exp-fill-mini" id="home-skill-exp-fill"></div>
                                </div>
                            </div>
                            <div id="home-skills-list" class="home-skills-grid">
                            </div>
                        </div>
                    </div>

                    <!-- 右下角 - 快捷入口 -->
                    <div class="home-panel home-quick-access">
                        <div class="home-panel-header">
                            <span class="panel-icon">🔮</span>
                            <span class="panel-title">快捷入口</span>
                        </div>
                        <div class="home-panel-content">
                            <div class="quick-access-grid">
                                <div class="quick-access-btn" onclick="switchToTab('storage')">
                                    <span class="quick-icon">📦</span>
                                    <span class="quick-label">仓库</span>
                                </div>
                                <div class="quick-access-btn" onclick="switchToTab('shop')">
                                    <span class="quick-icon">🛒</span>
                                    <span class="quick-label">商店</span>
                                </div>
                                <div class="quick-access-btn" onclick="switchToTab('pet')">
                                    <span class="quick-icon">🐾</span>
                                    <span class="quick-label">宠物</span>
                                </div>
                                <div class="quick-access-btn" onclick="switchToTab('settings')">
                                    <span class="quick-icon">⚙️</span>
                                    <span class="quick-label">设置</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 状态栏 -->
            <section id="status" class="panel">
                <div class="panel-header">
                    <h2>📊 角色状态</h2>
                    <button class="cyber-btn" onclick="addNewStat()">+ 添加属性</button>
                </div>
                <div id="stats-container" class="stats-container">
                </div>
            </section>

            <!-- 宠物 -->
            <section id="pet" class="panel">
                <div class="panel-header">
                    <h2>🐾 我的宠物</h2>
                    <div class="pet-food-display">🍖 × <span id="pet-food-amount">0</span></div>
                </div>
                
                <div id="pet-select-screen" class="pet-select-screen">
                    <h3>选择你的宠物伙伴</h3>
                    <div class="pet-options">
                        <div class="pet-option" onclick="selectPet('cat')">
                            <div class="pet-icon">🐱</div>
                            <div class="pet-option-name">小猫咪</div>
                        </div>
                        <div class="pet-option" onclick="selectPet('dog')">
                            <div class="pet-icon">🐶</div>
                            <div class="pet-option-name">小狗狗</div>
                        </div>
                        <div class="pet-option" onclick="selectPet('rabbit')">
                            <div class="pet-icon">🐰</div>
                            <div class="pet-option-name">小兔子</div>
                        </div>
                        <div class="pet-option" onclick="selectPet('bear')">
                            <div class="pet-icon">🐻</div>
                            <div class="pet-option-name">小熊熊</div>
                        </div>
                        <div class="pet-option" onclick="selectPet('panda')">
                            <div class="pet-icon">🐼</div>
                            <div class="pet-option-name">小熊猫</div>
                        </div>
                        <div class="pet-option" onclick="selectPet('fox')">
                            <div class="pet-icon">🦊</div>
                            <div class="pet-option-name">小狐狸</div>
                        </div>
                    </div>
                </div>

                <div id="pet-main-screen" class="pet-main-screen" style="display:none;">
                    <div class="pet-info-bar">
                        <div class="pet-stat">
                            <span class="pet-stat-label">等级</span>
                            <span class="pet-stat-value" id="pet-level">1</span>
                        </div>
                        <div class="pet-stat">
                            <span class="pet-stat-label">阶段</span>
                            <span class="pet-stage stage-0" id="pet-stage">基础形态</span>
                        </div>
                        <div class="pet-stat">
                            <span class="pet-stat-label">经验</span>
                            <div class="pet-exp-bar">
                                <div class="pet-exp-fill" id="pet-exp-fill"></div>
                                <span class="pet-exp-text" id="pet-exp-text">0/10</span>
                            </div>
                        </div>
                        <div class="pet-stat">
                            <span class="pet-stat-label">饥饿度</span>
                            <div class="pet-hunger-bar">
                                <div class="pet-hunger-fill" id="pet-hunger-fill"></div>
                            </div>
                        </div>
                    </div>

                    <div class="pet-display-area">
                        <div class="pet-character" id="pet-character">
                            <div class="pet-emoji" id="pet-emoji">🐱</div>
                            <div class="pet-name" id="pet-name-display">小猫咪</div>
                        </div>
                        <div class="pet-speech-bubble" id="pet-speech-bubble">
                            欢迎来看我呀！一起学习吧~ 📚
                        </div>
                    </div>

                    <div class="pet-actions">
                        <button class="cyber-btn" onclick="feedPet()">🍖 喂食</button>
                        <button class="cyber-btn" onclick="playWithPet()">🎾 互动</button>
                        <button class="cyber-btn" onclick="renamePet()">✏️ 改名</button>
                        <button class="cyber-btn" onclick="resetPet()" style="background: var(--neon-red);">🔄 更换宠物</button>
                    </div>

                    <div class="pet-collection-section">
                        <h4>📦 宠物收藏</h4>
                        <div id="pet-collection" class="pet-collection"></div>
                        <p class="collection-hint">完成番茄钟和挑战可获得新宠物！</p>
                    </div>

                    <div class="pet-evolution-info">
                        <h4>🌟 进化阶段</h4>
                        <div class="evolution-stages">
                            <div class="evolution-stage"><span class="stage-level">Lv.1-5</span><span class="stage-name">基础形态</span></div>
                            <div class="evolution-stage"><span class="stage-level">Lv.6-10</span><span class="stage-name">成长形态</span></div>
                            <div class="evolution-stage"><span class="stage-level">Lv.11-20</span><span class="stage-name">成熟形态</span></div>
                            <div class="evolution-stage"><span class="stage-level">Lv.21+</span><span class="stage-name">究极形态</span></div>
                        </div>
                    </div>

                    <div class="pet-tips">
                        <h4>💡 小贴士</h4>
                        <ul>
                            <li>完成学习任务可获得食物</li>
                            <li>每做对5道题获得1个食物</li>
                            <li>喂食可增加宠物经验值</li>
                            <li>宠物升级会变得更大更可爱</li>
                            <li>🌟 宠物达到一定等级会进化变形！</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 背包 -->
            <section id="backpack" class="panel">
                <div class="panel-header">
                    <h2>🎒 背包</h2>
                    <button class="cyber-btn" onclick="showAddItemModal('backpack')">+ 添加物品</button>
                </div>
                <div id="backpack-items" class="items-grid"></div>
            </section>

            <!-- 仓库 -->
            <section id="storage" class="panel">
                <div class="panel-header">
                    <h2>📦 仓库</h2>
                    <button class="cyber-btn" onclick="showAddItemModal('storage')">+ 添加物品</button>
                </div>
                <div id="storage-items" class="items-grid"></div>
            </section>

            <!-- 商店 -->
            <section id="shop" class="panel">
                <div class="panel-header">
                    <h2>🛒 商店</h2>
                    <div class="gold-display">
                        <span class="gold-icon">💰</span>
                        <span id="gold-amount">100</span>
                        <button class="cyber-btn-small" onclick="editGold()">编辑</button>
                    </div>
                </div>
                <div class="shop-controls">
                    <button class="cyber-btn" onclick="showAddShopItemModal()">+ 添加商品</button>
                </div>
                <div id="shop-items" class="items-grid"></div>
            </section>

            <!-- 思维地图 -->
            <section id="map" class="panel">
                <div class="panel-header">
                    <h2>🗺️ 思维地图</h2>
                </div>
                <div class="map-toolbar">
                    <button class="map-tool-btn" onclick="addMapNode()">
                        <span class="tool-icon">➕</span>
                        <span class="tool-text">添加</span>
                    </button>
                    <button class="map-tool-btn" id="connectModeBtn" onclick="toggleConnectMode()">
                        <span class="tool-icon">🔗</span>
                        <span class="tool-text">连线</span>
                    </button>
                    <button class="map-tool-btn danger" onclick="clearMap()">
                        <span class="tool-icon">🗑️</span>
                        <span class="tool-text">清空</span>
                    </button>
                </div>
                <div class="map-container" id="mapContainer">
                    <svg id="mapSvg" class="map-svg"></svg>
                    <div id="mapNodes" class="map-nodes"></div>
                </div>
                <div class="map-hint" id="mapHint">
                    <span>📱 提示：长按节点可拖动，点击标题展开详情</span>
                </div>
            </section>

            <!-- 技能树 -->
            <section id="skills" class="panel">
                <div class="panel-header">
                    <h2>⚡ 技能树</h2>
                    <button class="cyber-btn" id="add-skill-btn" onclick="showAddSkillModal()">+ 添加技能</button>
                </div>
                
                <div class="skill-status-bar">
                    <div class="skill-level-info">
                        <span class="skill-level-badge">Lv.<span id="skill-level">0</span></span>
                        <div class="skill-exp-container">
                            <div class="skill-exp-bar">
                                <div class="skill-exp-fill" id="skill-exp-fill" style="width: 0%"></div>
                            </div>
                            <span class="skill-exp-text"><span id="skill-exp">0</span>/<span id="skill-max-exp">100</span></span>
                        </div>
                    </div>
                    <div class="skill-fragments-display">
                        <span class="fragment-icon">🧩</span>
                        <span class="fragment-count">碎片: <span id="skill-fragments">0</span></span>
                        <button class="cyber-btn-small" onclick="synthesizeSkill()">合成技能</button>
                    </div>
                </div>

                <div id="skills-container" class="skills-container"></div>
            </section>

            <!-- 考验 -->
            <section id="challenge" class="panel">
                <div class="panel-header">
                    <h2>⚔️ 考验</h2>
                </div>
                <div class="challenge-tabs">
                    <button class="challenge-tab active" data-challenge="math">算术题</button>
                    <button class="challenge-tab" data-challenge="literacy">识字</button>
                </div>

                <div id="math-challenge" class="challenge-content active">
                    <button class="cyber-btn generate-btn" onclick="generateMathQuestions()">生成题目</button>
                    <div id="math-questions" class="questions-container"></div>
                    <button id="submit-math" class="cyber-btn submit-btn" style="display:none;" onclick="submitMathAnswers()">提交答案</button>
                    <div id="math-result" class="result-display"></div>
                </div>

                <div id="literacy-challenge" class="challenge-content">
                    <button class="cyber-btn generate-btn" onclick="generateLiteracyQuestion()">生成题目</button>
                    <div id="literacy-question" class="literacy-container"></div>
                    <div id="literacy-result" class="result-display"></div>
                </div>
            </section>

            <!-- 设置 -->
            <section id="settings" class="panel">
                <div class="panel-header">
                    <h2>⚙️ 设置</h2>
                </div>
                <div class="settings-container">
                    <div class="settings-section pomodoro-section">
                        <h3>🍅 番茄钟</h3>
                        <div class="pomodoro-display">
                            <div class="pomodoro-timer">
                                <span id="pomodoro-time" class="pomodoro-time">25:00</span>
                                <span id="pomodoro-status" class="pomodoro-status work">专注中</span>
                            </div>
                            <div class="pomodoro-controls">
                                <button id="pomodoro-toggle-btn" class="cyber-btn" onclick="togglePomodoro()">▶️ 开始</button>
                                <button class="cyber-btn" onclick="resetPomodoro()">🔄 重置</button>
                            </div>
                            <div class="pomodoro-stats">
                                <span>今日完成: <strong id="pomodoro-count">0</strong> 个番茄</span>
                            </div>
                        </div>
                        <div class="pomodoro-settings">
                            <div class="setting-row">
                                <label>工作时间 (分钟)</label>
                                <input type="number" id="work-time" value="25" min="1" max="60" 
                                       onchange="gameData.pomodoro.workTime=parseInt(this.value)||25;saveData();resetPomodoro();">
                            </div>
                            <div class="setting-row">
                                <label>休息时间 (分钟)</label>
                                <input type="number" id="break-time" value="5" min="1" max="30"
                                       onchange="gameData.pomodoro.breakTime=parseInt(this.value)||5;saveData();">
                            </div>
                        </div>
                    </div>

                    <div class="settings-section reminder-section">
                        <h3>⏰ 健康提醒</h3>
                        <div class="reminder-list">
                            <div class="reminder-item">
                                <label class="toggle-label">
                                    <input type="checkbox" id="reminder-drinkWater" checked onchange="toggleReminder('drinkWater')">
                                    <span class="toggle-slider"></span>
                                    💧 喝水提醒
                                </label>
                                <input type="number" class="interval-input" value="30" min="5" max="120" 
                                       onchange="setReminderInterval('drinkWater', this.value)"> 分钟
                            </div>
                            <div class="reminder-item">
                                <label class="toggle-label">
                                    <input type="checkbox" id="reminder-rest" checked onchange="toggleReminder('rest')">
                                    <span class="toggle-slider"></span>
                                    👀 休息眼睛提醒
                                </label>
                                <input type="number" class="interval-input" value="45" min="5" max="120"
                                       onchange="setReminderInterval('rest', this.value)"> 分钟
                            </div>
                            <div class="reminder-item">
                                <label class="toggle-label">
                                    <input type="checkbox" id="reminder-stretch" checked onchange="toggleReminder('stretch')">
                                    <span class="toggle-slider"></span>
                                    🧘 伸展活动提醒
                                </label>
                                <input type="number" class="interval-input" value="60" min="5" max="180"
                                       onchange="setReminderInterval('stretch', this.value)"> 分钟
                            </div>
                            <div class="reminder-item">
                                <label class="toggle-label">
                                    <input type="checkbox" id="reminder-petHunger" checked onchange="toggleReminder('petHunger')">
                                    <span class="toggle-slider"></span>
                                    🐾 宠物饥饿提醒
                                </label>
                                <span class="hint-text">(饥饿度低于30%时通知)</span>
                            </div>
                        </div>
                        <button class="cyber-btn" onclick="Notification.requestPermission().then(p=>showNotification('通知权限: '+p))">
                            🔔 启用桌面通知
                        </button>
                    </div>

                    <div class="settings-section">
                        <h3>🗑️ 数据管理</h3>
                        <p class="settings-desc">清除所有本地缓存数据，重置游戏进度。此操作不可撤销！</p>
                        <button class="cyber-btn danger-btn" onclick="showResetConfirmModal()">🔄 重置所有数据</button>
                    </div>
                    <div class="settings-section">
                        <h3>📊 数据统计</h3>
                        <div class="data-stats">
                            <div class="data-stat-item">
                                <span class="data-stat-label">属性数量</span>
                                <span class="data-stat-value" id="stats-count">0</span>
                            </div>
                            <div class="data-stat-item">
                                <span class="data-stat-label">技能数量</span>
                                <span class="data-stat-value" id="skills-count">0</span>
                            </div>
                            <div class="data-stat-item">
                                <span class="data-stat-label">背包物品</span>
                                <span class="data-stat-value" id="backpack-count">0</span>
                            </div>
                            <div class="data-stat-item">
                                <span class="data-stat-label">地图节点</span>
                                <span class="data-stat-value" id="map-count">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 首页使用物品确认弹窗 -->
    <div id="home-use-item-modal" class="modal">
        <div class="modal-content cyber-modal use-item-modal">
            <span class="close-btn" onclick="closeModal('home-use-item-modal')">&times;</span>
            <h3>🎒 使用物品</h3>
            <div id="home-use-item-content">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <!-- 首页使用技能确认弹窗 -->
    <div id="home-use-skill-modal" class="modal">
        <div class="modal-content cyber-modal use-skill-modal">
            <span class="close-btn" onclick="closeModal('home-use-skill-modal')">&times;</span>
            <h3>⚡ 使用技能</h3>
            <div id="home-use-skill-content">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <!-- 装备技能选择弹窗 -->
    <div id="equip-skill-modal" class="modal">
        <div class="modal-content cyber-modal equip-skill-modal">
            <span class="close-btn" onclick="closeModal('equip-skill-modal')">&times;</span>
            <h3>⭐ 选择技能装备</h3>
            <div id="equip-skill-list" class="equip-skill-list">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <!-- 换装弹窗 -->
    <div id="dress-up-modal" class="modal">
        <div class="modal-content cyber-modal dress-up-modal">
            <span class="close-btn" onclick="closeModal('dress-up-modal')">&times;</span>
            <h3>👔 角色换装</h3>
            <div class="dress-up-container">
                <div class="dress-up-preview">
                    <div class="preview-character">
                        <div class="pixel-character preview-char" id="preview-character">
                            <div class="char-accessory" id="preview-accessory"></div>
                            <div class="char-hair" id="preview-hair"></div>
                            <div class="char-head" id="preview-head"></div>
                            <div class="char-eyes" id="preview-eyes"></div>
                            <div class="char-mouth" id="preview-mouth"></div>
                            <div class="char-body" id="preview-body"></div>
                            <div class="char-legs" id="preview-legs"></div>
                        </div>
                    </div>
                    <div class="preview-name">
                        <input type="text" id="character-name-input" placeholder="角色名称" maxlength="8">
                    </div>
                </div>
                <div class="dress-up-options">
                    <div class="dress-category">
                        <h4>🎨 肤色</h4>
                        <div class="dress-items" id="skin-options"></div>
                    </div>
                    <div class="dress-category">
                        <h4>💇 发型</h4>
                        <div class="dress-items" id="hair-options"></div>
                    </div>
                    <div class="dress-category">
                        <h4>👀 眼睛</h4>
                        <div class="dress-items" id="eyes-options"></div>
                    </div>
                    <div class="dress-category">
                        <h4>👕 服装</h4>
                        <div class="dress-items" id="outfit-options"></div>
                    </div>
                    <div class="dress-category">
                        <h4>🎀 配饰</h4>
                        <div class="dress-items" id="accessory-options"></div>
                    </div>
                </div>
            </div>
            <div class="dress-up-actions">
                <button class="cyber-btn" onclick="randomizeCharacter()">🎲 随机</button>
                <button class="cyber-btn" onclick="saveDressUp()">💾 保存</button>
            </div>
        </div>
    </div>

    <!-- 模态框 -->
    <div id="stat-modal" class="modal">
        <div class="modal-content cyber-modal">
            <span class="close-btn" onclick="closeModal('stat-modal')">&times;</span>
            <h3>添加新属性</h3>
            <div class="form-group">
                <label>属性名称</label>
                <input type="text" id="stat-name" placeholder="如：生命值">
            </div>
            <div class="form-group">
                <label>当前值</label>
                <input type="number" id="stat-current" value="100">
            </div>
            <div class="form-group">
                <label>最大值</label>
                <input type="number" id="stat-max" value="100">
            </div>
            <div class="form-group">
                <label>颜色</label>
                <select id="stat-color">
                    <option value="red">红色</option>
                    <option value="blue">蓝色</option>
                    <option value="green">绿色</option>
                    <option value="yellow">黄色</option>
                    <option value="purple">紫色</option>
                    <option value="cyan">青色</option>
                </select>
            </div>
            <button class="cyber-btn" onclick="confirmAddStat()">确认添加</button>
        </div>
    </div>

    <div id="item-modal" class="modal">
        <div class="modal-content cyber-modal">
            <span class="close-btn" onclick="closeModal('item-modal')">&times;</span>
            <h3>添加物品</h3>
            <input type="hidden" id="item-target">
            <div class="form-group">
                <label>物品名称</label>
                <input type="text" id="item-name" placeholder="如：治疗药水">
            </div>
            <div class="form-group">
                <label>数量</label>
                <input type="number" id="item-quantity" value="1" min="1">
            </div>
            <div class="form-group">
                <label>效果属性（可选）</label>
                <select id="item-effect-stat"><option value="">无效果</option></select>
            </div>
            <div class="form-group">
                <label>效果数值</label>
                <input type="number" id="item-effect-value" value="0">
            </div>
            <div class="form-group">
                <label>描述</label>
                <textarea id="item-description" placeholder="物品描述..."></textarea>
            </div>
            <button class="cyber-btn" onclick="confirmAddItem()">确认添加</button>
        </div>
    </div>

    <div id="shop-modal" class="modal">
        <div class="modal-content cyber-modal">
            <span class="close-btn" onclick="closeModal('shop-modal')">&times;</span>
            <h3>添加商品</h3>
            <div class="form-group">
                <label>商品名称</label>
                <input type="text" id="shop-item-name" placeholder="如：能量饮料">
            </div>
            <div class="form-group">
                <label>价格（金币）</label>
                <input type="number" id="shop-item-price" value="10" min="1">
            </div>
            <div class="form-group">
                <label>效果属性（可选）</label>
                <select id="shop-item-effect-stat"><option value="">无效果</option></select>
            </div>
            <div class="form-group">
                <label>效果数值</label>
                <input type="number" id="shop-item-effect-value" value="0">
            </div>
            <div class="form-group">
                <label>描述</label>
                <textarea id="shop-item-description" placeholder="商品描述..."></textarea>
            </div>
            <button class="cyber-btn" onclick="confirmAddShopItem()">确认添加</button>
        </div>
    </div>

    <div id="edit-stat-modal" class="modal">
        <div class="modal-content cyber-modal">
            <span class="close-btn" onclick="closeModal('edit-stat-modal')">&times;</span>
            <h3>编辑属性</h3>
            <input type="hidden" id="edit-stat-id">
            <div class="form-group">
                <label>当前值</label>
                <input type="number" id="edit-stat-current">
            </div>
            <div class="form-group">
                <label>最大值</label>
                <input type="number" id="edit-stat-max">
            </div>
            <button class="cyber-btn" onclick="confirmEditStat()">确认修改</button>
        </div>
    </div>

    <div id="skill-modal" class="modal">
        <div class="modal-content cyber-modal">
            <span class="close-btn" onclick="closeModal('skill-modal')">&times;</span>
            <h3 id="skill-modal-title">添加技能</h3>
            <input type="hidden" id="skill-edit-id">
            <div class="form-group">
                <label>技能名称 *</label>
                <input type="text" id="skill-name" placeholder="如：火球术">
            </div>
            <div class="form-group">
                <label>技能描述</label>
                <textarea id="skill-description" placeholder="技能的描述..."></textarea>
            </div>
            <div class="form-group">
                <label>父技能（可选）</label>
                <select id="skill-parent"><option value="">无（根技能）</option></select>
            </div>
            <div class="form-group">
                <label>技能图标</label>
                <input type="text" id="skill-icon" placeholder="如：⚔️ 🔥 ⭐" value="⭐">
            </div>
            <div class="skill-effects-section">
                <h4>使用效果</h4>
                <div class="skill-effect-row">
                    <label>消耗属性</label>
                    <select id="skill-cost-stat"><option value="">无消耗</option></select>
                    <input type="number" id="skill-cost-value" placeholder="消耗数值" value="0">
                </div>
                <div class="skill-effect-row">
                    <label>获得属性</label>
                    <select id="skill-gain-stat"><option value="">无获得</option></select>
                    <input type="number" id="skill-gain-value" placeholder="获得数值" value="0">
                </div>
            </div>
            <button class="cyber-btn" onclick="confirmAddSkill()">确认</button>
        </div>
    </div>

    <div id="reset-modal" class="modal">
        <div class="modal-content cyber-modal reset-modal">
            <span class="close-btn" onclick="closeModal('reset-modal')">&times;</span>
            <div class="reset-warning">
                <div class="reset-icon">⚠️</div>
                <h3>确定要重置所有数据吗？</h3>
                <p>此操作将清除所有本地缓存数据，包括：</p>
                <ul class="reset-list">
                    <li>✦ 所有属性数值</li>
                    <li>✦ 宠物数据</li>
                    <li>✦ 背包和仓库物品</li>
                    <li>✦ 商店商品</li>
                    <li>✦ 技能树</li>
                    <li>✦ 思维地图</li>
                    <li>✦ 金币和食物</li>
                </ul>
                <p class="reset-warning-text">⚠️ 此操作不可撤销！</p>
            </div>
            <div class="reset-buttons">
                <button class="cyber-btn cancel-btn" onclick="closeModal('reset-modal')">取消</button>
                <button class="cyber-btn danger-btn" onclick="confirmReset()">确认重置</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
